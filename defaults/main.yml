---
# Whether to compile unbound from source or to use the package manager.
unbound_compile: false
# The unbound version to download the source from <https://unbound.net/download.html>
unbound_compile_version: 1.6.7
# Checksum to compare the download the file against <https://unbound.net/download.html>
unbound_compile_sha256: 4e7bd43d827004c6d51bef73adf941798e4588bdb40de5e79d89034d69751c9f
# The arguments given to the `./configure` command. <!--Solaris users should use --with-solaris-threads -->
unbound_compile_config: "--enable-dnscrypt --with-username={{unbound.server.username|default(unbound)}} --with-libevent --with-run-dir={{unbound.server.directory}} --with-conf-file={{unbound.server.directory}}/unbound.conf"

# Whether to use the optimisation guidelines from <http://unbound.nlnetlabs.nl/documentation/howto_optimise.html>
unbound_optimise: false
# Percentage of physical memory to use for unbound. Only used when `unbound_optimise` is true
unbound_optimise_memory: 100

## DNS-over-TLS settings
# see <https://github.com/publicarray/ansible-role-unbound/wiki/Examples#dns-over-tls> for an example
# Common name for cert signing request
unbound_tls_domain: example.com
# Certificate generation method. Must be one of: selfsigned,assertonly,acme,acme-cf. Only selfsigned and acme-cf are implemented at the moment.
unbound_tls_cert_provider: selfsigned
unbound_tls_dehydrated_src: /usr/local/src/dehydrated  # only used when unbound_tls_cert_provider == acme-cf
unbound_tls_dehydrated_etc: /usr/local/etc/dehydrated  # only used when unbound_tls_cert_provider == acme-cf
# Cloudflare email address
unbound_tls_cf_email:
# Cloudflare 'Global' API key <https://www.cloudflare.com/a/profile>
# DO NOT paste your plaintext key! <https://docs.ansible.com/ansible/latest/playbooks_vault.html>
unbound_tls_cf_api_key:
unbound_tls_cf_debug: true
# Let's Encrypt Certificate Authority <https://letsencrypt.org/docs/staging-environment/>
# Production: https://acme-v01.api.letsencrypt.org/directory
# Staging: https://acme-staging.api.letsencrypt.org/directory
unbound_tls_ca: https://acme-staging.api.letsencrypt.org/directory
# Production: https://acme-v01.api.letsencrypt.org/terms
# Staging: https://acme-staging.api.letsencrypt.org/terms
unbound_tls_ca_terms: https://acme-staging.api.letsencrypt.org/terms

### OpenNic <https://www.opennic.org/>
## The address and port for the authorative server e.g. nsd <https://nlnetlabs.nl/projects/nsd/>
# opennic_address: "127.0.0.1@5300"
## The TLDs served by the authorative server and OpenNic
# opennic_tlds: [ free, geek, oss, ... ]
#
## Example of Retriving OpenNIC TLDs
##
## - name: Get OpenNIC TLDs
##   shell: "dig @45.56.115.189 TXT tlds.opennic.glue +short | grep -v '^;' | sed s/\\\"//g | tr \" \" \"\\n\""
##   register: opennic_tlds_temp
##   check_mode: false
## - name: Set OpenNIC TLDs
##   set_fact:
##     opennic_tlds: "{{opennic_tlds_temp.stdout_lines}}"

## Main unbound configuration
# See <https://unbound.net/documentation/unbound.conf.html> for more options and detailed descriptions
# Note: In Ansible the variables must use underscores (_) not dashes (-) as separators
unbound:
  server:
    verbosity: 1
    # interface: [127.0.0.1, "::1"]
    # access_control: [0.0.0.0/0 allow, "::0 allow"]
    # use_syslog: no
    # log_time_ascii: yes
    logfile: "unbound.log"
    auto_trust_anchor_file: "root.key"
    root_hints: "root.hints"
    pidfile: "{{_unbound.pidfile|default('unbound.pid')}}"
    username: "{{_unbound.user}}"
    # If not compiling use distribution default directory else use unbound default directory
    directory: "{{_unbound.conf_dir if unbound_compile == false else \"/usr/local/etc/unbound\"}}"
    chroot: "{{_unbound.conf_dir if unbound_compile == false else \"/usr/local/etc/unbound\"}}"
    ## DNS-over-TLS
    # interface: [0.0.0.0@853, '::0@853']
    # ssl_service_key: "private.key"
    # ssl_service_pem: "certificate.pem"
    # ssl_port: 853
  remote_control:  # unbound-control
    control_enable: false
